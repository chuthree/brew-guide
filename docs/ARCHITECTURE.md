# Brew Guide é¡¹ç›®æ¶æ„æ–‡æ¡£

> é¢å‘å¼€å‘è€…çš„å¿«é€Ÿä¸Šæ‰‹æŒ‡å—ï¼Œå¸®åŠ©ä½ å¿«é€Ÿç†è§£é¡¹ç›®ç»“æ„

## æŠ€æœ¯æ ˆé€Ÿè§ˆ

| æŠ€æœ¯ | ç”¨é€” |
|------|------|
| Next.js 15 + React 19 | å‰ç«¯æ¡†æ¶ |
| Tailwind CSS 4 | æ ·å¼ |
| Zustand | çŠ¶æ€ç®¡ç† |
| Dexie (IndexedDB) | æœ¬åœ°æ•°æ®åº“ |
| Capacitor | ç§»åŠ¨ç«¯/æ¡Œé¢ç«¯æ‰“åŒ… |
| Framer Motion | åŠ¨ç”» |

---

## ç›®å½•ç»“æ„æ¦‚è§ˆ

```
src/
â”œâ”€â”€ app/              # Next.js App Router é¡µé¢
â”œâ”€â”€ components/       # UI ç»„ä»¶
â”œâ”€â”€ lib/              # æ ¸å¿ƒé€»è¾‘å’Œå·¥å…·
â”œâ”€â”€ providers/        # React Context Providers
â”œâ”€â”€ styles/           # å…¨å±€æ ·å¼å’Œå­—ä½“
â””â”€â”€ types/            # ç±»å‹å®šä¹‰
```

---

## æ ¸å¿ƒæ¨¡å—è¯´æ˜

### ğŸ“ `src/components/` - UI ç»„ä»¶

| ç›®å½• | è¯´æ˜ |
|------|------|
| `brewing/` | **å†²ç…®ç›¸å…³** - è®¡æ—¶å™¨ (`BrewingTimer`)ã€æ³¨æ°´å¯è§†åŒ– (`PourVisualizer`)ã€é˜¶æ®µæ§åˆ¶ |
| `coffee-bean/` | **å’–å•¡è±†ç®¡ç†** - åˆ—è¡¨ã€è¯¦æƒ…ã€è¡¨å•ã€äºŒç»´ç ã€è¯„åˆ†ã€å¹´åº¦æŠ¥å‘Šç­‰ |
| `notes/` | **å†²ç…®ç¬”è®°** - è®°å½•è¯¦æƒ…ã€è¡¨å•ã€åˆ—è¡¨ã€åˆ†äº« |
| `equipment/` | **å™¨å…·ç®¡ç†** - è‡ªå®šä¹‰å™¨å…·é…ç½® |
| `method/` | **å†²ç…®æ–¹æ¡ˆ** - æ–¹æ¡ˆé€‰æ‹©å’Œè‡ªå®šä¹‰ |
| `settings/` | **è®¾ç½®é¡µé¢** - å„ç±»è®¾ç½®é¡¹ç»„ä»¶ |
| `common/` | **é€šç”¨ç»„ä»¶** - å›¾ç‰‡é¢„è§ˆã€å¼¹çª—ã€è¡¨å•æ§ä»¶ç­‰ |
| `ui/` | **åŸºç¡€ UI** - æŒ‰é’®ç»„ã€ç ”ç£¨åº¦è¾“å…¥ç­‰åŸºç¡€æ§ä»¶ |
| `layout/` | **å¸ƒå±€ç»„ä»¶** - é¡µé¢å¸ƒå±€ç›¸å…³ |
| `onboarding/` | **å¼•å¯¼æµç¨‹** - æ–°ç”¨æˆ·å¼•å¯¼ |

### ğŸ“ `src/lib/` - æ ¸å¿ƒé€»è¾‘

| ç›®å½• | è¯´æ˜ |
|------|------|
| `core/` | **æ ¸å¿ƒæ¨¡å—** - æ•°æ®åº“ (`db.ts`)ã€é…ç½® (`config.ts`)ã€å­˜å‚¨å·¥å…· |
| `stores/` | **Zustand Store** - çŠ¶æ€ç®¡ç†ï¼ŒåŒ…æ‹¬å’–å•¡è±†ã€å†²ç…®ç¬”è®°ã€å™¨å…·ã€ç ”ç£¨å™¨ |
| `types/` | **ç±»å‹å®šä¹‰** - å†²ç…®æ–¹æ³•ç±»å‹ç­‰ |
| `hooks/` | **è‡ªå®šä¹‰ Hooks** |
| `utils/` | **å·¥å…·å‡½æ•°** |
| `app/` | **App ç›¸å…³** - Capacitor èƒ½åŠ›ã€æµè§ˆå™¨å…¼å®¹ã€å®‰å…¨åŒºåŸŸå¤„ç† |
| `sync/` | **åŒæ­¥åŸºç¡€** - åŒæ­¥ç®¡ç†å™¨åŸºç±» |
| `webdav/` | **WebDAV åŒæ­¥** - WebDAV å®¢æˆ·ç«¯å’ŒåŒæ­¥é€»è¾‘ |
| `s3/` | **S3 åŒæ­¥** - S3 å…¼å®¹å­˜å‚¨åŒæ­¥ |
| `brewing/` | **å†²ç…®é€»è¾‘** - å†²ç…®ç›¸å…³ä¸šåŠ¡é€»è¾‘ |
| `equipment/` | **å™¨å…·é€»è¾‘** - å™¨å…·ç›¸å…³ä¸šåŠ¡é€»è¾‘ |
| `grinder/` | **ç ”ç£¨å™¨** - ç ”ç£¨åº¦ç›¸å…³é€»è¾‘ |
| `audio/` | **éŸ³é¢‘** - å£°éŸ³æ’­æ”¾ |
| `navigation/` | **å¯¼èˆª** - è·¯ç”±å’Œå¯¼èˆªé€»è¾‘ |
| `managers/` | **ç®¡ç†å™¨** - å„ç±»ä¸šåŠ¡ç®¡ç†å™¨ |
| `api/` | **API** - æ¥å£è¯·æ±‚ |
| `ui/` | **UI å·¥å…·** - UI ç›¸å…³å·¥å…·å‡½æ•° |

### ğŸ“ `src/providers/` - Context Providers

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `StorageProvider.tsx` | å­˜å‚¨åˆå§‹åŒ–ï¼Œå¤„ç† IndexedDB å’Œæ•°æ®è¿ç§» |
| `CapacitorProvider.tsx` | Capacitor èƒ½åŠ›åˆå§‹åŒ–ï¼ˆåŸç”ŸåŠŸèƒ½ï¼‰ |
| `ModalHistoryProvider.tsx` | å¼¹çª—å†å²ç®¡ç†ï¼ˆæ”¯æŒè¿”å›é”®å…³é—­å¼¹çª—ï¼‰ |

---

## æ•°æ®å±‚æ¶æ„

### æ•°æ®åº“ (Dexie/IndexedDB)

ä½ç½®ï¼š`src/lib/core/db.ts`

```
BrewGuideDB
â”œâ”€â”€ brewingNotes    # å†²ç…®ç¬”è®°
â”œâ”€â”€ coffeeBeans     # å’–å•¡è±†
â”œâ”€â”€ customEquipments # è‡ªå®šä¹‰å™¨å…·
â”œâ”€â”€ customMethods   # è‡ªå®šä¹‰æ–¹æ¡ˆ
â””â”€â”€ settings        # åº”ç”¨è®¾ç½®
```

### çŠ¶æ€ç®¡ç† (Zustand)

ä½ç½®ï¼š`src/lib/stores/`

| Store | ç”¨é€” |
|-------|------|
| `coffeeBeanStore.ts` | å’–å•¡è±†åˆ—è¡¨å’Œæ“ä½œ |
| `brewingNoteStore.ts` | å†²ç…®ç¬”è®°ç®¡ç† |
| `equipmentStore.ts` | å™¨å…·é…ç½® |
| `grinderStore.ts` | ç ”ç£¨å™¨è®¾ç½® |

---

## å…³é”®æ–‡ä»¶å…¥å£

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `src/app/page.tsx` | åº”ç”¨ä¸»é¡µé¢å…¥å£ |
| `src/app/layout.tsx` | æ ¹å¸ƒå±€ï¼ŒåŒ…å« Providers |
| `src/lib/core/config.ts` | å…¨å±€é…ç½®å’Œç±»å‹å®šä¹‰ |
| `src/lib/core/db.ts` | æ•°æ®åº“å®šä¹‰å’Œå·¥å…·æ–¹æ³• |
| `capacitor.config.ts` | Capacitor é…ç½®ï¼ˆç§»åŠ¨ç«¯/æ¡Œé¢ç«¯ï¼‰ |

---

## å¼€å‘æµç¨‹

### å¯åŠ¨å¼€å‘

```bash
pnpm install   # å®‰è£…ä¾èµ–
pnpm dev       # å¯åŠ¨å¼€å‘æœåŠ¡å™¨ (localhost:3000)
```

### æ„å»º

```bash
pnpm build           # Web æ„å»º
pnpm cap:build       # ç§»åŠ¨ç«¯æ„å»ºå¹¶åŒæ­¥
pnpm build:desktop   # æ¡Œé¢ç«¯æ„å»ºï¼ˆéœ€è¦ Pakeï¼‰
```

### ç§»åŠ¨ç«¯è°ƒè¯•

```bash
pnpm cap:ios      # æ‰“å¼€ Xcode
pnpm cap:android  # æ‰“å¼€ Android Studio
```

---

## å¸¸è§å¼€å‘åœºæ™¯

### æ·»åŠ æ–°çš„è®¾ç½®é¡¹

1. åœ¨ `src/components/settings/` åˆ›å»ºè®¾ç½®ç»„ä»¶
2. åœ¨ `Settings.tsx` ä¸­å¼•å…¥
3. å¦‚éœ€æŒä¹…åŒ–ï¼Œä½¿ç”¨ `src/lib/core/storage.ts`

### æ·»åŠ æ–°çš„å’–å•¡è±†å­—æ®µ

1. ä¿®æ”¹ `src/types/app.d.ts` ä¸­çš„ `CoffeeBean` ç±»å‹
2. ä¿®æ”¹ `src/components/coffee-bean/Form/` ä¸­çš„è¡¨å•
3. ä¿®æ”¹ `src/components/coffee-bean/Detail/` ä¸­çš„è¯¦æƒ…å±•ç¤º

### æ·»åŠ æ–°çš„å†²ç…®å™¨å…·

1. åœ¨ `src/lib/core/config.ts` ä¸­æ·»åŠ å™¨å…·é…ç½®
2. æ·»åŠ å¯¹åº”å›¾æ ‡èµ„æº

### ä¿®æ”¹è®¡æ—¶å™¨é€»è¾‘

ä¸»è¦æ–‡ä»¶ï¼š
- `src/components/brewing/BrewingTimer.tsx` - è®¡æ—¶å™¨ä¸»ç»„ä»¶
- `src/components/brewing/Timer/` - è®¡æ—¶å™¨å­ç»„ä»¶
- `src/components/brewing/stages/` - é˜¶æ®µç›¸å…³ç»„ä»¶

---

## åŒæ­¥åŠŸèƒ½æ¶æ„

æ”¯æŒä¸¤ç§äº‘åŒæ­¥æ–¹å¼ï¼š

| æ–¹å¼ | ç›®å½• | è¯´æ˜ |
|------|------|------|
| WebDAV | `src/lib/webdav/` | æ”¯æŒ WebDAV åè®®çš„ç½‘ç›˜ |
| S3 | `src/lib/s3/` | S3 å…¼å®¹å­˜å‚¨ï¼ˆAWS S3ã€MinIO ç­‰ï¼‰ |

åŸºç±»ï¼š`src/lib/sync/BaseSyncManager.ts`

---

## èµ„æºæ–‡ä»¶

| ç›®å½• | è¯´æ˜ |
|------|------|
| `public/images/` | å›¾ç‰‡èµ„æºï¼ˆå›¾æ ‡ã€Logoã€æˆªå›¾ç­‰ï¼‰ |
| `public/sounds/` | éŸ³é¢‘èµ„æºï¼ˆæç¤ºéŸ³ï¼‰ |
| `public/data/` | æ•°æ®æ–‡ä»¶ï¼ˆå’–å•¡è±† CSV æ•°æ®åº“ï¼‰ |
| `assets/` | å…¶ä»–èµ„æº |

---

## å¤šç«¯æ”¯æŒ

| å¹³å° | æŠ€æœ¯ | ç›®å½• |
|------|------|------|
| Web/PWA | Next.js | `src/` |
| iOS | Capacitor | `ios/` |
| Android | Capacitor | `android/` |
| æ¡Œé¢ | Pake | é€šè¿‡ `build-desktop.sh` æ„å»º |


